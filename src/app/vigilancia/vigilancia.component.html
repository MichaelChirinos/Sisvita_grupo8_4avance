<div class="container mt-5">
    <div class="row">
        <div class="col text-center">
            <h2>Tests Realizados</h2>
        </div>
    </div>


    <!-- Filtros -->
    <div class="row mt-3">
        <div class="col-md-3">
            <div class="form-group">
                <label for="filtroNombrePaciente">Nombre Paciente:</label>
                <input type="text" class="form-control" id="filtroNombrePaciente" [(ngModel)]="filtroNombrePaciente" (input)="aplicarFiltros()">
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-group">
                <label for="filtroEscalaColor">Color de Escala:</label>
                <select class="form-control" id="filtroEscalaColor" [(ngModel)]="filtroEscalaColor" (change)="aplicarFiltros()">
                    <option value="">Todos</option>
                    <option value="green">Verde</option>
                    <option value="red">Rojo</option>
                    <option value="yellow">Amarillo</option>
                </select>
            </div>
        </div>
        <div class="col-md-3">
            <div class="form-group">
                <label>&nbsp;</label>
                <button class="btn btn-secondary btn-block" (click)="limpiarFiltros()">Limpiar Filtros</button>
            </div>
        </div>
    </div>


    <!-- Resultados de la búsqueda -->
    <div class="row mt-3">
        <div class="col">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>ID Test</th>
                        <th>Nombre Test</th>
                        <th>Nombre Paciente</th>
                        <th>Resultado</th>
                        <th>Fecha</th>
                        <th>Descripción</th>
                        <th>Escala</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let test of testsFiltrados">
                        <td>{{ test.id_test }}</td>
                        <td>{{ test.nombre_tipo_test }}</td>
                        <td>{{ test.nombre_paciente }}</td>
                        <td>{{ test.suma_respuestas }}</td>
                        <td>{{ test.fecha_realizacion | date }}</td>
                        <td>{{ test.descripcion }}</td>
                        <td>
                            <span [ngStyle]="{'background-color': test.color}" class="esfera"></span>
                        </td>
                        <td>
                            <button *ngIf="!test.confirmado" class="btn btn-primary" (click)="verDetalleTest(test.id_test)">Confirmar</button>
                            <button class="btn btn-primary" (click)="VerTest(test.id_test)">Ver Detalle</button>
                        </td>
                    </tr>
                    <tr *ngIf="testsFiltrados.length === 0">
                        <td colspan="8" class="text-center">No se encontraron resultados</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>


    <!-- Botón Retroceder al final de la sección de tests realizados -->
    <div class="row mt-4">
        <div class="col text-center">
            <a href="/listar-tipo-test" class="btn btn-primary">Retroceder</a>
        </div>
    </div>
</div>


<style>
    .esfera {
        display: inline-block;
        width: 20px;
        height: 20px;
        border-radius: 50%;
    }
</style>
